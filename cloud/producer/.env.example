# Example environment variables for local dev

# Endpoints
# - WORKFLOWS_BASE_URL: source of events (workflows service)
# - CONSUMER_BASE_URL: target consumer service that executes tools
WORKFLOWS_BASE_URL=http://host.docker.internal:3000
WORKFLOWS_AUDIENCE=http://host.docker.internal:3000
CONSUMER_BASE_URL=http://localhost:8080

# Optional inbound auth for the consumer (dev only). Leave unset to skip.
SERVICE_AUTH_TOKEN=devtoken

# Context for event subscription and forwarding
X_USER_ID=u-local
X_PROJECT_ID=p-local
# Optional
X_WORKSPACE_ID=
X_SESSION_ID=

# Replay cursors (optional)
SINCE_ID=
SINCE_TIME=

# Tuning
EVENTS_HEARTBEAT_MS=15000
RECONNECT_BACKOFF_MS=1000

# Optional: bucket and fuse flags for Cloud Storage mounting
# NOTE: The producer does not require storage by default. These vars are provided
# for consistency with the consumer. If you run the producer with any local
# processing that needs persistence, you may mount a bucket similarly.
# - GCS_BUCKET: name of the bucket you would mount
# - ENABLE_GCS_FUSE: set to true only if you explicitly use gcsfuse
GCS_BUCKET=
ENABLE_GCS_FUSE=false

# Downscoped GCS credentials (optional)
# If GCS_BUCKET is set, the producer will attempt to mint a downscoped access token
# using Application Default Credentials and pass it to the consumer via X-Gcs-Token.
# - GCS_PREFIX_TEMPLATE controls the object prefix boundary for the token
#   (supports {userId},{projectId},{workspaceId},{sessionId})
# - You can override minting by supplying an explicit token via GCS_TOKEN (or X_GCS_TOKEN)
GCS_PREFIX_TEMPLATE={userId}/{projectId}/{sessionId}/
GCS_TOKEN=
X_GCS_TOKEN=

# Enable consumer uploads back to GCS (default 1). The producer widens the CAB to
# include storage.objects.create when this is enabled so the consumer can upload
# using conditional ifGenerationMatch. Set to 0 to disable uploads.
GCS_ENABLE_UPLOAD=1

# GCS downscope config (CAB permission mode)
# Default permission mode is explicit:
#   availablePermissions: [storage.objects.get, storage.objects.list]
# Set to "role" to use:
#   availablePermissions: [inRole:roles/storage.objectViewer]
#GCS_CAB_PERMISSION_MODE=explicit

# Diagnostics for GCS downscope
# Set to 1|true|yes to enable detailed logging in producer (and consumer if set there)
#GCS_DEBUG=1
